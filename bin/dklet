#!/usr/bin/env rundklet
add_note <<~Note
  Base dklet settings and commands
Note

register_net

write_dockerfile <<~Desc
  FROM alpine:3.7
  LABEL <%=image_labels%>
Desc
register_docker_image 'docklet:newest'

task :main, preclean: false do
  puts "Welcome to dklet"
  invoke :help
end

custom_commands do
  desc 'init', 'init dklet'
  def init
    invoke :netup, [], {}

    system <<~Desc
      # ensure global volumes root exists
      sudo mkdir -p #{volumes_root}
      mkdir -p #{dklet_tmp_path}
    Desc

    puts "dklet ready to fly with you!"
  end
end
