#!/usr/bin/env rundklet
add_note <<~Note
  The Reliable, High Performance TCP/HTTP Load Balancer
  https://hub.docker.com/_/haproxy/
  https://cbonte.github.io/haproxy-dconv/
Note

# https://docs.docker.com/develop/develop-images/dockerfile_best-practices
write_dockerfile <<~Desc
  FROM haproxy:1.8
  LABEL maintainer=dailyops
  COPY haproxy.cfg /usr/local/etc/haproxy/haproxy.cfg
Desc

task :main do
  system <<~Desc
    docker run -it --rm --name haproxy-syntax-check #{docker_image} haproxy -c -f /usr/local/etc/haproxy/haproxy.cfg
  Desc
end
